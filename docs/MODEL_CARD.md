
## Цель проекта
Разработать модель бинарной классификации с учётом дисбаланса классов и калибровкой вероятностей. Задача — предсказывать уход клиентов для повышения эффективности удержания, оптимизации затрат и улучшения качества обслуживания.

## Источники данных
• Telco Customer Churn (Kaggle, IBM). Kaggle

## Требования к реализации
1. **Подготовка данных**: кодирование категорий, нормализация числовых признаков, анализ дисбаланса, базовые методы undersampling/oversampling в разумных пределах.
2. **Базовые модели и бейслайны**: majority class, логистическая регрессия.
3. **Модели**: деревья, ансамбли (RandomForest, Gradient Boosting, LightGBM, CatBoost), интерпретация (SHAP, feature importance)
.
4. **Валидация и калибровка**: стратифицированная K-fold, калибровка (Platt, изотоническая).
5. **Метрики**:
   - ROC-AUC 
   - PR-AUC (основная)
   - F1-score на оптимальном пороге
   - матрица ошибок и бизнес‑порог
6. **Отчёт**: выявление ключевых факторов риска, рекомендации по сегментации и удержанию.

## Краткая информация о данных
Данные содержат сведения о клиентах телеком-компании, их взаимодействии и платежах. В таблице представлены признаки: пол, возраст, наличие иждивенцев, тип интернета, длительность сотрудничества, способы оплаты и др. Целевая переменная — ушёл или нет.

Подробнее про структуру данных и описание признаков — в файле [DATA_README.md].

**Примерное описание признаков:**

- **customerID**: уникальный ID клиента
- **gender**: пол (Male/Female)
- **SeniorCitizen**: пенсионер (0/1)
- **Partner**, **Dependents**: есть ли партнер и иждивенцы
- **tenure**: месяцев в компании
- **PhoneService**, **MultipleLines**: наличие телефонных линий
- **InternetService**: тип интернета
- **OnlineSecurity**, **OnlineBackup**, **DeviceProtection**, **TechSupport**, **StreamingTV**, **StreamingMovies**: дополнительные услуги
- **Contract**: тип контракта
- **PaperlessBilling**: использовать ли безбумажный биллинг
- **PaymentMethod**: способ оплаты
- **MonthlyCharges**: ежемесячные платежи
- **TotalCharges**: сумма всех платежей
- **Churn**: целевая переменная (Yes/No)

---

**График ROC-кривой модели:**

<img src="images/ROC -кривая модели.png" alt="ROC-кривая модели" width="600">

**Топ-10 важных признаков по SHAP/feature importance:**

<img src="images\Топ-10 признаков.png" alt="ROC-кривая модели" width="600">

**Общая важность признаков:**

<img src="images\Важность признаков.png" alt="ROC-кривая модели" width="600">

**Анализа влияния ключевых признаков:**

<img src="images\Влияние признака RiskScore.png" alt="ROC-кривая модели" width="600">
<img src="images\Влияние признака InternetService_Fiber optic.png" alt="ROC-кривая модели" width="600">

---

## Метрики и trade-off-аналитика

**Таблица trade-off:**

| Порог | Precision | Recall | F1-Score | Кол-во клиентов с риском | Доля рисковых (%) |
|--------|------------|---------|----------|--------------------------|------------------|
| 0.1    | 0.357      | 0.971   | 0.522    | 1016                     | 72.2             |
| 0.2    | 0.408      | 0.930   | 0.567    | 853                      | 60.6             |
| 0.3    | 0.449      | 0.890   | 0.597    | 741                      | 52.7             |
| 0.4    | 0.488      | 0.824   | 0.613    | 631                      | 44.8             |
| 0.5    | 0.532      | 0.765   | 0.627    | 538                      | 38.2             |
| 0.6    | 0.585      | 0.655   | 0.618    | 419                      | 29.8             |
| 0.7    | 0.655      | 0.492   | 0.562    | 281                      | 20.0             |
| 0.8    | 0.698      | 0.302   | 0.422    | 162                      | 11.5             |
| 0.9    | 0.931      | 0.072   | 0.134    | 29                       | 2.1              |

*Дополнительные выводы:*

- Максимальный F1-Score достигается при пороге 0.5 (F1=0.627), что предлагает хороший баланс между точностью и отзывами.
- При пороге 0.1 можно охватить более 97% отзывов, что важно для высокой чувствительности, хотя точность ниже.
- Для очень высокой точности (>80%), сегмент клиентов очень узкий — всего 29 человек при пороге 0.9, что может быть актуально для задач, требующих высокой точности.

---

## Сегментация по риску оттока



| Сегмент          | Клиентов | Средняя вероятность ухода | Ожидаемый отток | Кол-во чел. |
|------------------|------------|----------------------------|-----------------|--------------|
| Критический риск | 162        | 86.3%                      | 140 чел        | 11.5%        |
| Высокий риск     | 257        | 69.8%                      | 179 чел        | 18.3%        |
| Средний риск     | 212        | 50.3%                      | 107 чел        | 15.1%        |
| Низкий риск      | 776        | 13.9%                      | 108 чел        | 55.2%        |

---

## Рекомендации по удержанию для каждого сегмента


| Сегмент             | Приоритет                                                      | Вероятность ухода | Меры удержания                                                                                                              | Бюджет на клиента           | Цель                         |
|---------------------|----------------------------------------------------------------|-------------------|------------------------------------------------------------------------------------------------------------------------------|------------------------------|------------------------------|
| Критический риск   | ВЫСШИЙ (действовать немедленно)                                | >80%              | • Личный звонок топ-менеджера в течение 24 часов<br>• Персональное предложение: скидка 20-30% на 6 месяцев<br>• Бесплатный апгрейд тарифа на 3 месяца<br>• Назначить персонального менеджера | Высокий (500-1000 руб/клиент) | Снизить отток на 60-70%     |
| Высокий риск       | ВЫСОКИЙ (действовать на этой неделе)                            | 60-80%            | • Звонок менеджера по удержанию в течение 3 дней<br>• Предложение: скидка 15% на 3 месяца<br>• Бесплатная дополнительная услуга на 1 месяц<br>• Опрос о причинах недовольства | Средний (200-500 руб/клиент) | Снизить отток на 40-50%     |
| Средний риск       | СРЕДНИЙ (проактивная работа)                                    | 40-60%            | • Автоматическое email-письмо с опросом<br>• Предложение: скидка 10% при продлении<br>• Напоминание о преимуществах тарифа<br>• Приглашение на вебинар о новых функциях | Низкий (50-100 руб/клиент)       | Снизить отток на 20-30%     |
| Низкий риск        | НИЗКИЙ (поддержание лояльности)                                  | <40%              | • Регулярные информационные рассылки<br>• Программа лояльности: бонусы за длительность<br>• Спасибо-письмо за длительное сотрудничество<br>• Приглашение в реферальную программу | Минимальный (10-30 руб/клиент) | Поддержание лояльности, перекрестные продажи |



**ИТОГОВЫЕ метрики модели на тестовых данных:**

- ROC-AUC: 0.832
- PR-AUC: 0.641
- F1-Score: 0.609
- Precision: 0.583
- Recall: 0.636
- Accuracy: 0.783

---

## Ограничения и риски применения модели
- **Дисбаланс классов**: менее 30% уходящих — возможны ложные отрицания.
- **Обработка признаков**: требуют аккуратной кодировки и нормализации.
- **Калибровка вероятностей**: важна для бизнес‑решений.
- **Обновление данных**: модель может деградировать при смене ситуации.
- **Интерпретируемость**: сложные ансамбли требуют визуализации и объяснений.
- **Этические риски**: возможное дискриминирование по признакам.

---
