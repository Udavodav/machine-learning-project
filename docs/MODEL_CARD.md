
## Цель проекта
Разработать модель бинарной классификации с учётом дисбаланса классов и калибровкой вероятностей. Задача — предсказывать уход клиентов для повышения эффективности удержания, оптимизации затрат и улучшения качества обслуживания.

## Источники данных
• Telco Customer Churn (Kaggle, IBM). Kaggle

## Требования к реализации
1. **Подготовка данных**: кодирование категорий, нормализация числовых признаков, анализ дисбаланса, базовые методы undersampling/oversampling в разумных пределах.
2. **Базовые модели и бейслайны**: majority class, логистическая регрессия.
3. **Модели**: деревья, ансамбли (RandomForest, Gradient Boosting, LightGBM, CatBoost), интерпретация (SHAP, feature importance)
.
4. **Валидация и калибровка**: стратифицированная K-fold, калибровка (Platt, изотоническая).
5. **Метрики**:
   - ROC-AUC 
   - PR-AUC (основная)
   - F1-score на оптимальном пороге
   - матрица ошибок и бизнес‑порог
6. **Отчёт**: выявление ключевых факторов риска, рекомендации по сегментации и удержанию.

## Краткая информация о данных
Данные содержат сведения о клиентах телеком-компании, их взаимодействии и платежах. В таблице представлены признаки: пол, возраст, наличие иждивенцев, тип интернета, длительность сотрудничества, способы оплаты и др. Целевая переменная — ушёл или нет.

Подробнее про структуру данных и описание признаков — в файле [DATA_README.md].

**Примерное описание признаков:**

- **customerID**: уникальный ID клиента
- **gender**: пол (Male/Female)
- **SeniorCitizen**: пенсионер (0/1)
- **Partner**, **Dependents**: есть ли партнер и иждивенцы
- **tenure**: месяцев в компании
- **PhoneService**, **MultipleLines**: наличие телефонных линий
- **InternetService**: тип интернета
- **OnlineSecurity**, **OnlineBackup**, **DeviceProtection**, **TechSupport**, **StreamingTV**, **StreamingMovies**: дополнительные услуги
- **Contract**: тип контракта
- **PaperlessBilling**: использовать ли безбумажный биллинг
- **PaymentMethod**: способ оплаты
- **MonthlyCharges**: ежемесячные платежи
- **TotalCharges**: сумма всех платежей
- **Churn**: целевая переменная (Yes/No)

---

**График ROC-кривой модели:**

<img src="images/ROC -кривая модели.png" alt="ROC-кривая модели" width="600">

**Топ-10 важных признаков по SHAP/feature importance:**

<img src="images\Топ-10 признаков.png" alt="ROC-кривая модели" width="600">

**Общая важность признаков:**

<img src="images\Важность признаков.png" alt="ROC-кривая модели" width="600">

**Анализа влияния ключевых признаков:**

<img src="images\Влияние признака RiskScore.png" alt="ROC-кривая модели" width="600">
<img src="images\Влияние признака InternetService_Fiber optic.png" alt="ROC-кривая модели" width="600">

---

## Метрики и trade-off-аналитика

**Таблица trade-off:**

| Порог | Precision | Recall | F1-Score | Кол-во клиентов с риском | Доля рисковых (%) |
|--------|------------|---------|----------|--------------------------|------------------|
| 0.1    | 0.361      | 0.957   | 0.525    | 991                      | 70.4             |
| 0.2    | 0.430      | 0.909   | 0.584    | 791                      | 56.2             |
| 0.3    | 0.472      | 0.837   | 0.604    | 663                      | 47.1             |
| 0.4    | 0.531      | 0.749   | 0.622    | 527                      | 37.5             |
| 0.5    | 0.564      | 0.639   | 0.599    | 424                      | 30.1             |
| 0.6    | 0.626      | 0.532   | 0.575    | 318                      | 22.6             |
| 0.7    | 0.699      | 0.385   | 0.497    | 206                      | 14.6             |
| 0.8    | 0.743      | 0.217   | 0.335    | 109                      | 7.7              |
| 0.9    | 0.816      | 0.083   | 0.150    | 38                       | 2.7              |

*Дополнительные выводы:*

- Максимальный F1 достигается при пороге 0.4 (F1=0.622), что позволяет выбрать баланс чувствительности и точности.
- При пороге 0.1 можно достичь более 95% отзывов (recall), но снизить точность.
- В случае высокой точности (>80%), клиентский сегмент очень узкий (38 человек).

---

## Сегментация по риску оттока

| Сегмент | Клиентов | Средняя вероятность ухода | Ожидаемый отток | Кол-во чел. |
|----------|------------|--------------------------|----------------|--------------|
| Критический риск | 109 | 88.2% | 96 чел | 7.7% |
| Высокий риск | 209 | 69.1% | 144 чел | 14.9% |
| Средний риск | 209 | 49.8% | 104 чел | 14.9% |
| Низкий риск | 880 | 14.1% | 124 чел | 62.5% |

---

## Рекомендации по удержанию для каждого сегмента


| Сегмент             | Приоритет                                                      | Вероятность ухода | Меры удержания                                                                                                              | Бюджет на клиента           | Цель                         |
|---------------------|----------------------------------------------------------------|-------------------|------------------------------------------------------------------------------------------------------------------------------|------------------------------|------------------------------|
| Критический риск   | ВЫСШИЙ (действовать немедленно)                                | >80%              | • Личный звонок топ-менеджера в течение 24 часов<br>• Персональное предложение: скидка 20-30% на 6 месяцев<br>• Бесплатный апгрейд тарифа на 3 месяца<br>• Назначить персонального менеджера | Высокий (500-1000 руб/клиент) | Снизить отток на 60-70%     |
| Высокий риск       | ВЫСОКИЙ (действовать на этой неделе)                            | 60-80%            | • Звонок менеджера по удержанию в течение 3 дней<br>• Предложение: скидка 15% на 3 месяца<br>• Бесплатная дополнительная услуга на 1 месяц<br>• Опрос о причинах недовольства | Средний (200-500 руб/клиент) | Снизить отток на 40-50%     |
| Средний риск       | СРЕДНИЙ (проактивная работа)                                    | 40-60%            | • Автоматическое email-письмо с опросом<br>• Предложение: скидка 10% при продлении<br>• Напоминание о преимуществах тарифа<br>• Приглашение на вебинар о новых функциях | Низкий (50-100 руб/клиент)       | Снизить отток на 20-30%     |
| Низкий риск        | НИЗКИЙ (поддержание лояльности)                                  | <40%              | • Регулярные информационные рассылки<br>• Программа лояльности: бонусы за длительность<br>• Спасибо-письмо за длительное сотрудничество<br>• Приглашение в реферальную программу | Минимальный (10-30 руб/клиент) | Поддержание лояльности, перекрестные продажи |



**ИТОГОВЫЕ метрики модели на тестовых данных:**

- ROC-AUC: 0.832
- PR-AUC: 0.641
- F1-Score: 0.609
- Precision: 0.583
- Recall: 0.636
- Accuracy: 0.783

---

## Ограничения и риски применения модели
- **Дисбаланс классов**: менее 30% уходящих — возможны ложные отрицания.
- **Обработка признаков**: требуют аккуратной кодировки и нормализации.
- **Калибровка вероятностей**: важна для бизнес‑решений.
- **Обновление данных**: модель может деградировать при смене ситуации.
- **Интерпретируемость**: сложные ансамбли требуют визуализации и объяснений.
- **Этические риски**: возможное дискриминирование по признакам.

---
