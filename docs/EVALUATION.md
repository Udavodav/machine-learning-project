
## Стратегия валидации

Разбиение данных
Train/Test split: 70/30  
Train/Val split: 80/20 (для калибровки)  
Test set: 1,407 samples (фиксированный hold-out)  
Стратификация: Сохранение баланса классов во всех сплитах  
Random state: 42 (для воспроизводимости)


### Метрики оценки
#### Основные метрики
| Метрика | Цель | Порог успеха |
|---------|------|--------------|
| ROC-AUC | Основная метрика проекта | ≥ 0.75 |
| F1-Score | Баланс Precision/Recall | Максимизировать |
| Precision | Точность предсказания оттока | > 0.55 |
| Recall | Полнота выявления оттока | > 0.60 |
# Стоимость ошибок

COST_FP = 10  # Ложное предупреждение (напрасный контакт)
COST_FN = 50  # Пропущенный отток (потеря клиента)


### Кросс-валидация
```
StratifiedKFold(
    n_splits=5,
    shuffle=True,
    random_state=42
)
```

### Результаты CV по наборам данных

Balanced Medium (финальный выбор):
- ROC-AUC: 0.895 ± 0.003
- F1-Score: 0.605 ± 0.002
- Стабильность: Высокая (низкий std)

Unbalanced:
- ROC-AUC: 0.848 ± 0.013
- F1-Score: 0.583 ± 0.014
- Стабильность: Средняя

Balanced:
- ROC-AUC: 0.910 ± 0.003
- F1-Score: 0.610 ± 0.003
- Стабильность: Низкая (риск переобучения)


### Процедура отбора финальной модели

#### Критерии отбора (веса)  
- ROC-AUC на тесте (40%) - основной критерий проекта
- Стабильность (25%) - разрыв между train/test ROC-AUC
- F1-Score (20%) - баланс Precision/Recall
- Бизнес-релевантность (15%) - соответствие бизнес-целям


####  Матрица сравнения моделей

|Модель|ROC-AUC|Разрыв|F1|Precision|Recall|Итоговый балл|
|---|---|---|---|---|---|---|
|Unbalanced GB|0.841|0.011|0.581|0.657|0.521|72.3|
|**Balanced Medium RF**|**0.829**|**0.066**|**0.610**|**0.576**|**0.647**|**76.8**|
|Balanced RF|0.830|0.080|0.617|0.545|0.711|73.5

### Обоснование выбора

**Выбрана модель: Random Forest на Balanced Medium данных**

####  Причины:

- Оптимальный баланс метрик: F1-Score 0.610 (лучший компромисс)
- Приемлемая стабильность: Разрыв 0.066 (меньше, чем у Balanced)
- Высокая полнота: Recall 0.647 (находит 64.7% ушедших)
- Достаточная точность: Precision 0.576 (приемлемо для бизнеса)
- Соответствие требованию: ROC-AUC 0.829 > 0.75

#### Отклоненные варианты:

- Unbalanced GB: Слишком низкий Recall (52.1%) - пропускаем почти половину ушедших
- Balanced RF: Высокий риск переобучения (разрыв 0.080) и низкая Precision (54.5%)
